<!DOCTYPE html>
<html>
<head>
  <style>
    body {
      background-position: center center;
      background-repeat: repeat-x repeat-y;
      color: white;
      font-family: Futura, sans;
    }
    div {
      margin: 3em;
    }
    span {
      background-color: rgba(0,0,0,0.5);
      border-radius: 1em;
      padding: 1em;
    }
    #image {
      display: none;
    }
  </style>
  <script>
    function rescale() {
      var width = document.getElementById('image').width;
      var slider = document.getElementById('slider');
      var val = slider.value;
      var scale = 1/(16 - val);
      var denominator = (4*(16 - val));
      var numerator = 4;

      while (denominator % 2 == 0 && numerator % 2 == 0) {
        denominator /= 2;
        numerator /= 2;
      }
      document.body.style.backgroundSize = width * scale + 'px';
      document.getElementById('percentage').innerHTML = (100 * scale).toFixed(3).replace(/0+$/, '').replace(/\.$/, '') + '% &bull; <sup>' + numerator + '</sup>/<sub>' + denominator + '</sub>';
    }

    function setImage(imageURL) {
      document.getElementById('slider').value = 15;
      rescale();
      document.body.style.backgroundSize = 'auto';
      document.body.style.backgroundImage = 'url(' + imageURL + ')';
      document.getElementById('image').src = imageURL;
    }

    function handleFileSelect(evt) {
      evt.stopPropagation();
      evt.preventDefault();
      var files = evt.dataTransfer.files;

      var reader = new FileReader();

      for (var i = 0, f; f = files[i]; i++) {
        if (f.type.match(/image.*/)) {
          reader.onload = function(e) {
            document.location.hash = '';
            setImage(e.target.result);
          };
          reader.readAsDataURL(f);
          break;
        }
      }
    }

    function handleDragOver(evt) {
      evt.stopPropagation();
      evt.preventDefault();
      evt.dataTransfer.dropEffect = 'none';
      var files = evt.dataTransfer.files;

      for (var i = 0, f; f = files[i]; i++) {
        if (f.type.match(/image.*/)) {
          evt.dataTransfer.dropEffect = 'link';
          break;
        }
      }
    }

    function onImageLoad() {
        document.getElementById('help').style.display = 'none';
        var slider = document.getElementById('slider');
        slider.disabled = false;
        slider.focus();
    }

    function onHashChange() {
      if (document.location.hash.slice(1)) {
        setImage(document.location.hash.slice(1))
      } else {
        document.getElementById('help').style.display = 'block';
      }
    }

    function onPageLoad() {
      var dropZone = document.getElementsByTagName('html')[0];
      dropZone.addEventListener('dragover', handleDragOver, false);
      dropZone.addEventListener('drop', handleFileSelect, false);

      document.getElementById('image').addEventListener('load', onImageLoad);
      document.getElementById('slider').addEventListener('change', rescale);

      window.addEventListener('hashchange', onHashChange, false);
      onHashChange();
    }
  </script>
</head>
<body onload="onPageLoad()">
  <center>
    <div id="help">
      <span>Drop any image here to try it as a background.</span>
    </div>
    <div>
      <span>
        <input type="range" min="0" max="15" value="15" step="0.25" id="slider" disabled>
      </span>
    </div>
    <div>
      <span id="percentage">100% &bull; <sup>1</sup>/<sub>1</sub></span>
    </div>
    <img id="image"/>
  </center>
</body>